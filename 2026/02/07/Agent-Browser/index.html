<!DOCTYPE HTML>
<html>

<head>

  <meta charset="utf-8">
  
  <title>从 Playwright 到 agent-browser：基于 Accessibility Tree 的浏览器自动化与 AI Agent 实践 | Andrew&#39;s Blog</title>
  <meta name="author" content="Andrew">
  
  <meta name="description" content="这篇文章整理了一次从『传统浏览器自动化测试』一路深入到『AI Agent 驱动浏览器操作』的完整思考路径，核心关键词包括 Playwright、Rust、playwright-rs、agent-browser、Accessibility Tree、LLM。如果你正在思考如何让浏览器自动化更稳、更智能">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="从 Playwright 到 agent-browser：基于 Accessibility Tree 的浏览器自动化与 AI Agent 实践"/>
  <meta property="og:site_name" content="Andrew&#39;s Blog"/>

  
    <meta property="og:image" content=""/>
  

  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/notebook.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/tabs.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>
  <script src="/js/tabs.js"></script>

  <!-- analytics -->
  



<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
    <!-- End of mathjax configuration -->

<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">Andrew&#39;s Blog</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">		
			<h1> 从 Playwright 到 agent-browser：基于 Accessibility Tree 的浏览器自动化与 AI Agent 实践</h1>
		</div>		
	



<div class="row post">
	<!-- cols -->
	
	<div class="col-md-9">
	

			

	<!-- content -->
	<div class="mypage">
	    <p>这篇文章整理了一次从『传统浏览器自动化测试』一路深入到『AI Agent 驱动浏览器操作』的完整思考路径，核心关键词包括 <strong>Playwright</strong>、<strong>Rust</strong>、<strong>playwright-rs</strong>、<strong>agent-browser</strong>、<strong>Accessibility Tree</strong>、<strong>LLM</strong>。如果你正在思考如何让浏览器自动化更稳、更智能，或者如何把 LLM 接进真实网页操作，这篇总结可以作为一份系统性参考。</p>
<hr>
<h2 id="一、浏览器自动化的三条路线"><a href="#一、浏览器自动化的三条路线" class="headerlink" title="一、浏览器自动化的三条路线"></a>一、浏览器自动化的三条路线</h2><p>在讨论具体工具前，先明确三种常见路线：</p>
<ol>
<li><p><strong>官方 Playwright（Node.js &#x2F; Python &#x2F; Java &#x2F; .NET）</strong><br>工程能力最强，生态最成熟，适合严肃的 E2E 测试。</p>
</li>
<li><p><strong>Rust + Playwright</strong><br>通过 Rust bindings 调用 Playwright（如 <code>playwright-rs</code>），在 Rust 工程内完成浏览器自动化。</p>
</li>
<li><p><strong>Rust WebDriver &#x2F; Selenium 生态</strong><br>标准化强，但对现代浏览器能力（自动等待、可访问性、trace）支持有限。</p>
</li>
</ol>
<p>本文重点集中在 <strong>路线 2</strong> 以及由此延伸出的 <strong>agent-browser + LLM</strong> 思路。</p>
<hr>
<h2 id="二、playwright-rs：在-Rust-中写浏览器自动化测试"><a href="#二、playwright-rs：在-Rust-中写浏览器自动化测试" class="headerlink" title="二、playwright-rs：在 Rust 中写浏览器自动化测试"></a>二、playwright-rs：在 Rust 中写浏览器自动化测试</h2><p><code>playwright-rs</code> 是目前最有前途的 Rust Playwright 绑定：</p>
<ul>
<li>基于 <strong>官方 Playwright Server（Node.js）</strong></li>
<li>Rust 侧通过 JSON-RPC 调用</li>
<li>支持 Chromium &#x2F; Firefox &#x2F; WebKit</li>
<li>支持 Linux &#x2F; macOS &#x2F; Windows</li>
<li>已在 GitHub Actions 跨平台跑通</li>
</ul>
<h3 id="一个最小的-Rust-测试用例"><a href="#一个最小的-Rust-测试用例" class="headerlink" title="一个最小的 Rust 测试用例"></a>一个最小的 Rust 测试用例</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[tokio::test]</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">fn</span> <span class="title function_">smoke_test</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;(), <span class="type">Box</span>&lt;<span class="keyword">dyn</span> std::error::Error&gt;&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">pw</span> = Playwright::<span class="title function_ invoke__">launch</span>().<span class="keyword">await</span>?;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">browser</span> = pw.<span class="title function_ invoke__">chromium</span>().<span class="title function_ invoke__">launch</span>().<span class="keyword">await</span>?;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">page</span> = browser.<span class="title function_ invoke__">new_page</span>().<span class="keyword">await</span>?;</span><br><span class="line"></span><br><span class="line">    page.<span class="title function_ invoke__">goto</span>(<span class="string">&quot;https://example.com&quot;</span>, <span class="literal">None</span>).<span class="keyword">await</span>?;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">heading</span> = page.<span class="title function_ invoke__">locator</span>(<span class="string">&quot;role=heading&quot;</span>).<span class="keyword">await</span>;</span><br><span class="line">    <span class="built_in">assert!</span>(heading.<span class="title function_ invoke__">is_visible</span>().<span class="keyword">await</span>?);</span><br><span class="line"></span><br><span class="line">    browser.<span class="title function_ invoke__">close</span>().<span class="keyword">await</span>?;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关键点在于：推荐使用 role &#x2F; name 等基于可访问性语义的 locator，而不是 CSS selector。</p>
<hr>
<h2 id="三、Accessibility-Tree-是什么？为什么它更稳？"><a href="#三、Accessibility-Tree-是什么？为什么它更稳？" class="headerlink" title="三、Accessibility Tree 是什么？为什么它更稳？"></a>三、Accessibility Tree 是什么？为什么它更稳？</h2><ol>
<li><p>它不是 DOM</p>
<p>Accessibility Tree 是浏览器内部为屏幕阅读器和辅助技术维护的一棵语义树：</p>
<ul>
<li>节点是 button &#x2F; textbox &#x2F; heading &#x2F; link</li>
<li>而不是 div &#x2F; span</li>
<li>包含 role、accessible name、state（disabled&#x2F;checked&#x2F;expanded）</li>
</ul>
<p>它由浏览器从 DOM + CSS + ARIA 自动计算生成。</p>
</li>
<li><p>为什么适合自动化与 AI ？</p>
<ul>
<li>更贴近『人类理解的页面结构』</li>
<li>对 class、布局、嵌套不敏感</li>
<li>天然支持『这个按钮叫什么』『这个输入框是干嘛的』</li>
</ul>
</li>
</ol>
<p>Playwright 原生支持基于 accessibility 的定位，这也是它明显强于 Selenium 的地方。</p>
<p>ARIA（Accessible Rich Internet Applications）是一套给 Web 元素补充『语义、名称和状态』的规范，<br>浏览器据此计算 Accessibility Tree，供辅助技术、测试工具和 AI 使用。<br>ARIA 不是 Accessibility Tree 的『开关』，而是『校准器』；没有 ARIA，浏览器也能计算出树，只是精度可能不同。</p>
<hr>
<h2 id="四、Selenium-为什么很难支持-Accessibility-Tree-？"><a href="#四、Selenium-为什么很难支持-Accessibility-Tree-？" class="headerlink" title="四、Selenium 为什么很难支持 Accessibility Tree ？"></a>四、Selenium 为什么很难支持 Accessibility Tree ？</h2><p>结论先行：<br>Selenium 短期内几乎不可能完整支持 accessibility tree。</p>
<br />

<p>原因包括：</p>
<ul>
<li>WebDriver 标准主要围绕 DOM</li>
<li>Accessibility Tree 属于浏览器内部语义模型</li>
<li>AOM（Accessibility Object Model）仍处于实验&#x2F;讨论阶段</li>
<li>不同浏览器、不同操作系统的无障碍实现差异巨大</li>
</ul>
<p>因此，Selenium 通常只能：</p>
<ul>
<li>结合 axe-core 等工具做无障碍检测</li>
<li>而不是『读取并操作 accessibility tree』</li>
</ul>
<hr>
<h2 id="五、agent-browser：为-AI-Agent-设计的浏览器控制层"><a href="#五、agent-browser：为-AI-Agent-设计的浏览器控制层" class="headerlink" title="五、agent-browser：为 AI Agent 设计的浏览器控制层"></a>五、<a target="_blank" rel="noopener" href="https://github.com/vercel-labs/agent-browser">agent-browser</a>：为 AI Agent 设计的浏览器控制层</h2><ol>
<li>agent-browser 是什么<ul>
<li>Vercel Labs 出品</li>
<li>一个 Rust CLI + Playwright 后端 的工具</li>
<li>不是测试框架，而是『浏览器操作协议的 CLI 实现』</li>
</ul>
</li>
</ol>
<p>它的核心创新是：</p>
<p>snapshot + ref-id 的交互模型</p>
<hr>
<ol start="2">
<li>snapshot 的工作原理<ol>
<li>从 Playwright 读取页面的 accessibility tree</li>
<li>语义裁剪（去掉无关节点）</li>
<li>为每个节点分配稳定的引用 ID（如 @e2）</li>
<li>输出一份『当前页面可操作状态』</li>
</ol>
</li>
</ol>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@e1  heading &quot;Log in to Miro&quot;</span><br><span class="line">@e2  textbox &quot;Email&quot;</span><br><span class="line">@e3  button &quot;Continue&quot;</span><br></pre></td></tr></table></figure>

<hr>
<ol start="3">
<li>用 ref-id 操作页面</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">agent-browser fill @e2 <span class="string">&quot;test@example.com&quot;</span></span><br><span class="line">agent-browser click @e3</span><br></pre></td></tr></table></figure>

<p>完全不需要 CSS selector。</p>
<hr>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span><span class="nb">source</span><span class="w"> </span>~/.bashrc
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />
<p>第一步：确认你的环境前提</p>
<p>agent-browser 的现实前提有三点，缺一不可。</p>
<p>第一，macOS 本身没有问题，Intel 或 Apple Silicon 都可以。
第二，需要 <strong>Node.js（用于 Playwright）</strong>。
第三，需要 <strong>Rust（用于 agent-browser CLI）</strong>。</p>
<p>你可以先快速确认一下：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>node<span class="w"> </span>-v
npm<span class="w"> </span>-v
rustc<span class="w"> </span>--version
cargo<span class="w"> </span>--version
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>v20.19.4
10.8.2
rustc 1.58.1 (db9d1b20b 2022-01-20)
cargo 1.58.0 (f01b232bc 2022-01-19)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>如果 Node 没装，建议直接用：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>brew<span class="w"> </span>install<span class="w"> </span>node
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>pnpm<span class="w"> </span>setup
pnpm<span class="w"> </span>config<span class="w"> </span>get<span class="w"> </span>global-dir
mkdir<span class="w"> </span>-p<span class="w"> </span>~/.pnpm-global
pnpm<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>global-dir<span class="w"> </span>~/.pnpm-global
<span class="nb">source</span><span class="w"> </span>~/.zshrc
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>如果 Rust 没装：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>curl<span class="w"> </span>--proto<span class="w"> </span><span class="s1">&#39;=https&#39;</span><span class="w"> </span>--tlsv1.2<span class="w"> </span>-sSf<span class="w"> </span>https://sh.rustup.rs<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>rustup<span class="w"> </span>update<span class="w"> </span>stable
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>或者：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>curl<span class="w"> </span>--proto<span class="w"> </span><span class="s1">&#39;=https&#39;</span><span class="w"> </span>--tlsv1.2<span class="w"> </span>-sSf<span class="w"> </span>https://sh.rustup.rs<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh<span class="w"> </span>-s<span class="w"> </span>--<span class="w"> </span>-y<span class="w"> </span>--profile<span class="w"> </span>minimal
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>rustup<span class="w"> </span>update<span class="w"> </span>stable
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>装完记得重新开一个 shell，确保 <code>cargo</code> 在 PATH 里。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />
<p>第二步：安装 Playwright（这是最容易被忽略的一步）</p>
<p>agent-browser <strong>不是直接控制浏览器</strong>，它底层仍然依赖 Playwright 的 browser binaries。</p>
<p>在一个干净目录里执行一次即可：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>npx<span class="w"> </span>playwright<span class="w"> </span>install
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>或者：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>playwright@latest
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>playwright<span class="w"> </span>--version
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Version 1.58.2
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>playwright<span class="w"> </span>install
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>这一步会下载 Chromium / Firefox / WebKit。
macOS 上第一次运行浏览器时，系统可能会弹出『安全性与隐私』提示，允许即可。</p>
<p>如果这一步没做，后面 agent-browser 会『能启动，但打不开页面』。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />
<p>第三步：安装 agent-browser CLI</p>
<p>现在开始真正的 agent-browser。</p>
<p>官方仓库是：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/vercel-labs/agent-browser">https://github.com/vercel-labs/agent-browser</a></p>
<p>最直接、最稳妥的方式是 <strong>从源码安装</strong>：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/vercel-labs/agent-browser.git
<span class="nb">cd</span><span class="w"> </span>agent-browser
pnpm<span class="w"> </span>install
pnpm<span class="w"> </span>build
pnpm<span class="w"> </span>build:native<span class="w">   </span><span class="c1"># Requires Rust (https://rustup.rs)</span>
pnpm<span class="w"> </span>link<span class="w"> </span>--global<span class="w">  </span><span class="c1"># Makes agent-browser available globally</span>
agent-browser<span class="w"> </span>install
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>安装成功后，你应该能看到：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>agent-browser<span class="w"> </span>--help
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
agent-browser - fast browser automation CLI for AI agents

Usage: agent-browser &lt;command&gt; [args] [options]

Core Commands:
  open &lt;url&gt;                 Navigate to URL
  click &lt;sel&gt;                Click element (or @ref)
  dblclick &lt;sel&gt;             Double-click element
  type &lt;sel&gt; &lt;text&gt;          Type into element
  fill &lt;sel&gt; &lt;text&gt;          Clear and fill
  press &lt;key&gt;                Press key (Enter, Tab, Control+a)
  hover &lt;sel&gt;                Hover element
  focus &lt;sel&gt;                Focus element
  check &lt;sel&gt;                Check checkbox
  uncheck &lt;sel&gt;              Uncheck checkbox
  select &lt;sel&gt; &lt;val...&gt;      Select dropdown option
  drag &lt;src&gt; &lt;dst&gt;           Drag and drop
  upload &lt;sel&gt; &lt;files...&gt;    Upload files
  download &lt;sel&gt; &lt;path&gt;      Download file by clicking element
  scroll &lt;dir&gt; [px]          Scroll (up/down/left/right)
  scrollintoview &lt;sel&gt;       Scroll element into view
  wait &lt;sel|ms&gt;              Wait for element or time
  screenshot [path]          Take screenshot
  pdf &lt;path&gt;                 Save as PDF
  snapshot                   Accessibility tree with refs (for AI)
  eval &lt;js&gt;                  Run JavaScript
  connect &lt;port|url&gt;         Connect to browser via CDP
  close                      Close browser

Navigation:
  back                       Go back
  forward                    Go forward
  reload                     Reload page

Get Info:  agent-browser get &lt;what&gt; [selector]
  text, html, value, attr &lt;name&gt;, title, url, count, box, styles

Check State:  agent-browser is &lt;what&gt; &lt;selector&gt;
  visible, enabled, checked

Find Elements:  agent-browser find &lt;locator&gt; &lt;value&gt; &lt;action&gt; [text]
  role, text, label, placeholder, alt, title, testid, first, last, nth

Mouse:  agent-browser mouse &lt;action&gt; [args]
  move &lt;x&gt; &lt;y&gt;, down [btn], up [btn], wheel &lt;dy&gt; [dx]

Browser Settings:  agent-browser set &lt;setting&gt; [value]
  viewport &lt;w&gt; &lt;h&gt;, device &lt;name&gt;, geo &lt;lat&gt; &lt;lng&gt;
  offline [on|off], headers &lt;json&gt;, credentials &lt;user&gt; &lt;pass&gt;
  media [dark|light] [reduced-motion]

Network:  agent-browser network &lt;action&gt;
  route &lt;url&gt; [--abort|--body &lt;json&gt;]
  unroute [url]
  requests [--clear] [--filter &lt;pattern&gt;]

Storage:
  cookies [get|set|clear]    Manage cookies (set supports --url, --domain, --path, --httpOnly, --secure, --sameSite, --expires)
  storage &lt;local|session&gt;    Manage web storage

Tabs:
  tab [new|list|close|&lt;n&gt;]   Manage tabs

Debug:
  trace start|stop [path]    Record trace
  record start &lt;path&gt; [url]  Start video recording (WebM)
  record stop                Stop and save video
  console [--clear]          View console logs
  errors [--clear]           View page errors
  highlight &lt;sel&gt;            Highlight element

Sessions:
  session                    Show current session name
  session list               List active sessions

Setup:
  install                    Install browser binaries
  install --with-deps        Also install system dependencies (Linux)

Snapshot Options:
  -i, --interactive          Only interactive elements
  -c, --compact              Remove empty structural elements
  -d, --depth &lt;n&gt;            Limit tree depth
  -s, --selector &lt;sel&gt;       Scope to CSS selector

Options:
  --session &lt;name&gt;           Isolated session (or AGENT_BROWSER_SESSION env)
  --profile &lt;path&gt;           Persistent browser profile (or AGENT_BROWSER_PROFILE env)
  --state &lt;path&gt;             Load storage state from JSON file (or AGENT_BROWSER_STATE env)
  --headers &lt;json&gt;           HTTP headers scoped to URL&#39;s origin (for auth)
  --executable-path &lt;path&gt;   Custom browser executable (or AGENT_BROWSER_EXECUTABLE_PATH)
  --extension &lt;path&gt;         Load browser extensions (repeatable)
  --args &lt;args&gt;              Browser launch args, comma or newline separated (or AGENT_BROWSER_ARGS)
                             e.g., --args &#34;--no-sandbox,--disable-blink-features=AutomationControlled&#34;
  --user-agent &lt;ua&gt;          Custom User-Agent (or AGENT_BROWSER_USER_AGENT)
  --proxy &lt;server&gt;           Proxy server URL (or AGENT_BROWSER_PROXY)
                             e.g., --proxy &#34;http://user:pass@127.0.0.1:7890&#34;
  --proxy-bypass &lt;hosts&gt;     Bypass proxy for these hosts (or AGENT_BROWSER_PROXY_BYPASS)
                             e.g., --proxy-bypass &#34;localhost,*.internal.com&#34;
  --ignore-https-errors      Ignore HTTPS certificate errors
  --allow-file-access        Allow file:// URLs to access local files (Chromium only)
  -p, --provider &lt;name&gt;      Browser provider: ios, browserbase, kernel, browseruse
  --device &lt;name&gt;            iOS device name (e.g., &#34;iPhone 15 Pro&#34;)
  --json                     JSON output
  --full, -f                 Full page screenshot
  --headed                   Show browser window (not headless)
  --cdp &lt;port&gt;               Connect via CDP (Chrome DevTools Protocol)
  --debug                    Debug output
  --version, -V              Show version

Environment:
  AGENT_BROWSER_SESSION          Session name (default: &#34;default&#34;)
  AGENT_BROWSER_EXECUTABLE_PATH  Custom browser executable path
  AGENT_BROWSER_PROVIDER         Browser provider (ios, browserbase, kernel, browseruse)
  AGENT_BROWSER_STREAM_PORT      Enable WebSocket streaming on port (e.g., 9223)
  AGENT_BROWSER_IOS_DEVICE       Default iOS device name
  AGENT_BROWSER_IOS_UDID         Default iOS device UDID

Examples:
  agent-browser open example.com
  agent-browser snapshot -i              # Interactive elements only
  agent-browser click @e2                # Click by ref from snapshot
  agent-browser fill @e3 &#34;test@example.com&#34;
  agent-browser find role button click --name Submit
  agent-browser get text @e1
  agent-browser screenshot --full
  agent-browser --cdp 9222 snapshot      # Connect via CDP port
  agent-browser --profile ~/.myapp open example.com  # Persistent profile

iOS Simulator (requires Xcode and Appium):
  agent-browser -p ios open example.com                    # Use default iPhone
  agent-browser -p ios --device &#34;iPhone 15 Pro&#34; open url   # Specific device
  agent-browser -p ios device list                         # List simulators
  agent-browser -p ios swipe up                            # Swipe gesture
  agent-browser -p ios tap @e1                             # Touch element

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>如果提示 command not found，检查 <code>$HOME/.cargo/bin</code> 是否在 PATH 中。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />
<p>第四步：做一次最小可行测试（不接 LLM）</p>
<p>不要一上来就连 LLM，先验证三件事：</p>
<ol>
<li>Playwright 能起浏览器</li>
<li>agent-browser 能读 accessibility tree</li>
<li>snapshot 能正常输出</li>
</ol>
<p>按顺序来：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>agent-browser<span class="w"> </span>open<span class="w"> </span>https://miro.com/login/<span class="w"> </span>--headed
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-green-fg">✓</span> <span class="ansi-bold">Sign in | Miro | The Visual Workspace for Innovation</span>
  https://miro.com/login/
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你应该能看到浏览器窗口被打开。</p>
<p>接着：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>agent-browser<span class="w"> </span>snapshot
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>- document:
  - button &#34;Skip to main content&#34; [ref=e1]
  - banner:
    - link &#34;Go to Miro main page&#34; [ref=e2]:
      - /url: /index/
      - text: Miro Logo
    - button &#34;Language&#34; [ref=e3]: en
    - text: &#34;Current language is: English&#34;
    - link &#34;Sign up&#34; [ref=e4]:
      - /url: https://miro.com/signup/
  - main:
    - heading &#34;Sign in to Miro&#34; [ref=e5] [level=1]
    - group &#34;Sign-in options&#34;:
      - button &#34;SSO&#34; [ref=e6]
      - button &#34;Google&#34; [ref=e7]
      - button &#34;Microsoft 365&#34; [ref=e8]
      - button &#34;Show more sign-in options&#34; [ref=e9]
    - text: Email
    - textbox &#34;Email&#34; [ref=e10]:
      - /placeholder: Enter your email address
    - text: Password
    - textbox &#34;Password&#34; [ref=e11]:
      - /placeholder: Enter your password
    - link &#34;Forgot password?&#34; [ref=e12]:
      - /url: https://miro.com/recover/
    - checkbox &#34;Remember me&#34; [ref=e13] [checked]
    - paragraph:
      - paragraph: Remember me
    - button &#34;Continue with email&#34; [ref=e14]
    - button &#34;Sign in to a different region or a private organization&#34; [ref=e15]
    - paragraph:
      - text: Trouble signing in?
      - link &#34;Request a magic sign in link&#34; [ref=e16]:
        - /url: /login/passwordless/
      - text: or
      - link &#34;reset your password&#34; [ref=e17]:
        - /url: /recover/
      - text: .
  - alert
  - iframe
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>正常情况下，会输出类似：</p>
<pre><code>@e1 heading &quot;Example Domain&quot;
@e2 paragraph &quot;This domain is for use in illustrative examples...&quot;
@e3 link &quot;More information...&quot;
</code></pre>
<p>只要这一步成功，说明你的 <strong>macOS + Playwright + agent-browser 环境是健康的</strong>。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />
<p>第五步：实际操作页面（验证 ref-id 模型）</p>
<p>继续在 example.com 上试：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>agent-browser<span class="w"> </span>click<span class="w"> </span>@e22
agent-browser<span class="w"> </span>snapshot
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你会看到页面发生变化，ref-id 全部重新分配。
这一步非常关键，它验证了你对 agent-browser 核心原则的理解：</p>
<blockquote>
<p>ref-id 只在当前 snapshot 有意义</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>agent-browser<span class="w"> </span>click<span class="w"> </span>@e4
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>agent-browser<span class="w"> </span>fill<span class="w"> </span>@e6<span class="w"> </span><span class="s2">&quot;andy@dtype.info&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />
<p>第六步：测试一个真实复杂页面（推荐）</p>
<p>不要立刻上 Miro、Google 这种登录页，先选一个『复杂但不反爬』的页面，比如：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>agent-browser<span class="w"> </span>open<span class="w"> </span>https://news.ycombinator.com
agent-browser<span class="w"> </span>snapshot
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你会看到大量：</p>
<pre><code>@e1 link &quot;Hacker News&quot;
@e2 link &quot;new&quot;
@e3 link &quot;past&quot;
...
</code></pre>
<p>试着：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-bash"><pre><span></span>agent-browser<span class="w"> </span>click<span class="w"> </span>@e2
agent-browser<span class="w"> </span>snapshot
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>如果这一步稳定，说明 accessibility tree + ref-id 在真实页面上是可用的。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />
<p>第七步：macOS 上几个非常常见的坑</p>
<p>这里是我强烈建议你提前注意的：</p>
<ol>
<li><p><strong>中文输入法干扰</strong>
在 fill textbox 时，尽量用英文输入法，否则某些页面会出现奇怪的 key event。</p>
</li>
<li><p><strong>系统权限</strong>
第一次运行 Playwright 控制的浏览器时，macOS 可能阻止『自动化控制』。
去：
系统设置 → 隐私与安全性 → 辅助功能 / 自动化
放行你的终端（iTerm / Terminal）。</p>
</li>
<li><p><strong>页面一变就 snapshot</strong>
不 snapshot 就继续 click / fill，是 agent-browser 使用中最常见的逻辑错误。</p>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />
<p>第八步：准备接 LLM（但暂时别急）</p>
<p>在 macOS 上，推荐的下一步架构是：</p>
<ul>
<li>agent-browser 作为 <strong>纯执行层</strong></li>
<li>你自己写一个 <strong>controller（Rust / Python / Node 都行）</strong></li>
<li>LLM 只负责：<ul>
<li>读 snapshot 文本</li>
<li>输出下一条命令（严格受限）</li>
</ul>
</li>
</ul>
<p>现在这个阶段，<strong>先不要上 MCP、不要上多 agent</strong>，先把『单步 → snapshot → 单步』这条链跑顺。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />

</div>
</div>
</div>
 




<hr>
<h2 id="六、用-agent-browser-操作-Miro-登录页（示例）"><a href="#六、用-agent-browser-操作-Miro-登录页（示例）" class="headerlink" title="六、用 agent-browser 操作 Miro 登录页（示例）"></a>六、用 agent-browser 操作 Miro 登录页（示例）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">agent-browser open https://miro.com/login/</span><br><span class="line">agent-browser snapshot</span><br><span class="line">agent-browser fill @e2 <span class="string">&quot;test@example.com&quot;</span></span><br><span class="line">agent-browser click @e3</span><br><span class="line">agent-browser snapshot</span><br></pre></td></tr></table></figure>

<p>核心原则只有一句话：<br>页面一变，就重新 snapshot。<br>ref-id 是『当前页面状态下的逻辑锚点』，不是全局 ID。</p>
<hr>
<h2 id="七、agent-browser-vs-playwright-mcp"><a href="#七、agent-browser-vs-playwright-mcp" class="headerlink" title="七、agent-browser vs playwright-mcp"></a>七、agent-browser vs playwright-mcp</h2><table>
<thead>
<tr>
<th>维度&nbsp;&nbsp;</th>
<th>&nbsp;&nbsp;agent-browser&nbsp;&nbsp;</th>
<th>&nbsp;&nbsp;playwright-mcp</th>
</tr>
</thead>
<tbody><tr>
<td>形态&nbsp;&nbsp;</td>
<td>&nbsp;&nbsp;CLI 工具&nbsp;&nbsp;</td>
<td>&nbsp;&nbsp;MCP Server</td>
</tr>
<tr>
<td>面向对象&nbsp;&nbsp;</td>
<td>&nbsp;&nbsp;脚本 &#x2F; AI Agent&nbsp;&nbsp;</td>
<td>&nbsp;&nbsp;MCP 客户端（IDE &#x2F; 桌面）</td>
</tr>
<tr>
<td>交互方式&nbsp;&nbsp;</td>
<td>&nbsp;&nbsp;命令 + snapshot&nbsp;&nbsp;</td>
<td>&nbsp;&nbsp;工具调用</td>
</tr>
<tr>
<td>状态管理&nbsp;&nbsp;</td>
<td>&nbsp;&nbsp;外部控制器&nbsp;&nbsp;</td>
<td>&nbsp;&nbsp;MCP 会话</td>
</tr>
<tr>
<td>适合场景&nbsp;&nbsp;</td>
<td>&nbsp;&nbsp;自建 agent loop、&nbsp;&nbsp;<br />&nbsp;&nbsp;CI、脚本&nbsp;&nbsp;</td>
<td>&nbsp;&nbsp;IDE 内 AI 助手</td>
</tr>
</tbody></table>
<br />

<p>一句话区分：</p>
<ul>
<li>agent-browser：浏览器能力 &#x3D; 一组命令</li>
<li>playwright-mcp：浏览器能力 &#x3D; MCP 工具集</li>
</ul>
<hr>
<h2 id="八、如何把-LLM-和-agent-browser-结合？"><a href="#八、如何把-LLM-和-agent-browser-结合？" class="headerlink" title="八、如何把 LLM 和 agent-browser 结合？"></a>八、如何把 LLM 和 agent-browser 结合？</h2><p>典型的 ReAct &#x2F; Tool Loop：</p>
<ol>
<li>open 页面</li>
<li>snapshot 获取页面状态</li>
<li>把 snapshot + 目标发给 LLM</li>
<li>LLM 输出下一条命令（受限 DSL）</li>
<li>执行命令</li>
<li>重复直到完成或失败</li>
</ol>
<p>关键工程要点：</p>
<ul>
<li>命令白名单</li>
<li>域名限制</li>
<li>步数 &#x2F; 时间上限</li>
<li>失败自动截图</li>
</ul>
<p>本质分工是：<br>LLM 负责决策，agent-browser 负责执行。</p>
<br />

<p>使用 agent-browser 搭配 Claude Code 的方法也一并介绍。</p>
<p>通过在 AGENTS.md &#x2F; CLAUDE.md 中像下面这样写明 agent-browser 的操作方式，就可以让 Claude Code 具备浏览器操作能力。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">## Browser Automation</span></span><br><span class="line"></span><br><span class="line">Use <span class="code">`agent-browser`</span> for web automation. Run <span class="code">`agent-browser --help`</span> for all commands.</span><br><span class="line"></span><br><span class="line">Core workflow:</span><br><span class="line"><span class="bullet">1.</span> <span class="code">`agent-browser open &lt;url&gt;`</span> - Navigate to page</span><br><span class="line"><span class="bullet">2.</span> <span class="code">`agent-browser snapshot -i`</span> - Get interactive elements with refs (@e1, @e2)</span><br><span class="line"><span class="bullet">3.</span> <span class="code">`agent-browser click @e1`</span> / <span class="code">`fill @e2 &quot;text&quot;`</span> - Interact using refs</span><br><span class="line"><span class="bullet">4.</span> Re-snapshot after page change</span><br></pre></td></tr></table></figure>

<p>安装 <a target="_blank" rel="noopener" href="https://mac.getutm.app/">UTM</a> &#x2F; <a target="_blank" rel="noopener" href="https://cua.ai/docs/lume">Lume</a></p>
<p>安装 <a target="_blank" rel="noopener" href="https://ubuntu.com/download/server/arm">Ubuntu Server for ARM</a> &#x2F; macOS</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[FAILED] Failed unmounting cdrom.mount - /cdrom</span><br><span class="line">Please remove the installation medium, <span class="keyword">then</span> press ENTER</span><br></pre></td></tr></table></figure>

<p>在 UTM 里操作方法如下。</p>
<ol>
<li>在 UTM 窗口顶部菜单点击虚拟机的设置按钮</li>
<li>找到 CD&#x2F;DVD 或 Drives</li>
<li>把挂载的 Ubuntu ISO 文件移除（Eject &#x2F; Clear &#x2F; 删除 ISO）</li>
</ol>
<p>做完后，再回到虚拟机窗口按 ENTER。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">IFACE=$(ip -o <span class="built_in">link</span> show | awk -F<span class="string">&#x27;: &#x27;</span> <span class="string">&#x27;&#123;print $2&#125;&#x27;</span> | grep -v lo | <span class="built_in">head</span> -n1)</span><br><span class="line"></span><br><span class="line">sudo bash -c <span class="string">&quot;cat &gt; /etc/netplan/01-netcfg.yaml &lt;&lt;EOF</span></span><br><span class="line"><span class="string">network:</span></span><br><span class="line"><span class="string">  version: 2</span></span><br><span class="line"><span class="string">  renderer: networkd</span></span><br><span class="line"><span class="string">  ethernets:</span></span><br><span class="line"><span class="string">    <span class="variable">$&#123;IFACE&#125;</span>:</span></span><br><span class="line"><span class="string">      dhcp4: true</span></span><br><span class="line"><span class="string">EOF&quot;</span></span><br><span class="line"></span><br><span class="line">sudo <span class="built_in">chmod</span> 600 /etc/netplan/01-netcfg.yaml</span><br><span class="line">sudo netplan generate</span><br><span class="line">sudo netplan apply</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ip a</span><br><span class="line">ip route</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/bin/bash -c <span class="string">&quot;<span class="subst">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> &gt;&gt; /home/hijirii/.bashrc</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;eval &quot;$(/home/linuxbrew/.linuxbrew/bin/brew shellenv bash)&quot;&#x27;</span> &gt;&gt; /home/hijirii/.bashrc</span><br><span class="line"><span class="built_in">eval</span> <span class="string">&quot;<span class="subst">$(/home/linuxbrew/.linuxbrew/bin/brew shellenv bash)</span>&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="subst">$(whoami)</span> ALL=(ALL) NOPASSWD: ALL&quot;</span> | sudo <span class="built_in">tee</span> /etc/sudoers.d/$(<span class="built_in">whoami</span>) &gt; /dev/null</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash</span><br><span class="line"><span class="built_in">export</span> NVM_DIR=<span class="string">&quot;<span class="variable">$HOME</span>/.nvm&quot;</span></span><br><span class="line">[ -s <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span> ] &amp;&amp; \. <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span>  <span class="comment"># This loads nvm</span></span><br><span class="line">[ -s <span class="string">&quot;<span class="variable">$NVM_DIR</span>/bash_completion&quot;</span> ] &amp;&amp; \. <span class="string">&quot;<span class="variable">$NVM_DIR</span>/bash_completion&quot;</span>  <span class="comment"># This loads nvm bash_completion</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm install 22 &amp;&amp; nvm <span class="built_in">alias</span> default 22 &amp;&amp; nvm use 22</span><br></pre></td></tr></table></figure>

<p>安装并配置 <a target="_blank" rel="noopener" href="https://github.com/openclaw/openclaw">OpenClaw</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install -g openclaw@latest</span><br><span class="line">openclaw onboard --install-daemon</span><br></pre></td></tr></table></figure>

<p>配置局域网终端访问 OpenClaw Dashboard</p>
<ul>
<li>配置 <a target="_blank" rel="noopener" href="https://tailscale.com/">Tailscale</a></li>
<li>配置 Nginx<br>1.⁠ ⁠配置 Nginx HTTPS 反向代理<br>2.⁠ ⁠修改 OpenClaw 配置 - 添加 ⁠<code>controlUi.dangerouslyDisableDeviceAuth: true</code> (<a target="_blank" rel="noopener" href="https://docs.openclaw.ai/web/control-ui#device-pairing-first-connection">Device pairing</a>)<br>3.⁠ ⁠重启 Gateway - 尝试让新配置生效</li>
</ul>
<h2 id="配置-OpenClaw"><a href="#配置-OpenClaw" class="headerlink" title="配置 OpenClaw"></a>配置 OpenClaw</h2><h3 id="禁用-web-search"><a href="#禁用-web-search" class="headerlink" title="禁用 web_search"></a>禁用 web_search</h3><p>如果不想使用 Brave API（需要绑定信用卡），可以在配置中禁用 web_search：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openclaw config <span class="built_in">set</span> <span class="string">&#x27;tools.web.search.enabled&#x27;</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>重启后 <code>web_search</code> 工具将被禁用，<code>web_fetch</code> 仍然可用。如需禁用 web_fetch：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openclaw config <span class="built_in">set</span> <span class="string">&#x27;tools.web.fetch.enabled&#x27;</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<h3 id="新增-Skill-时添加环境变量"><a href="#新增-Skill-时添加环境变量" class="headerlink" title="新增 Skill 时添加环境变量"></a>新增 Skill 时添加环境变量</h3><p>当创建的 Skill 需要环境变量（如 API 密钥、路径）时，有三种方式配置：</p>
<p><em>1. 每次调用时传递（推荐自定义变量）</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;tool&quot;</span><span class="punctuation">:</span> <span class="string">&quot;exec&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;agent-browser open https://example.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;env&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;AGENT_BROWSER_HOME&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/home/hijirii/.openclaw/workspace/agent-browser&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;MY_API_KEY&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xxx&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><em>2. 配置 PATH 预置目录</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openclaw config <span class="built_in">set</span> tools.exec.pathPrepend <span class="string">&#x27;[&quot;/home/hijirii/.cargo/bin&quot;, &quot;/opt/bin&quot;]&#x27;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>⚠️ 注意：exec 工具不会读取 <code>~/.bashrc</code> 或 <code>~/.profile</code>，需要使用上述方式配置。对于 <code>host=gateway</code>，<code>env.PATH</code> 会被拒绝（安全限制），请使用 <code>pathPrepend</code> 代替。</p>
</blockquote>
<hr>
<h2 id="九、整体对照总结"><a href="#九、整体对照总结" class="headerlink" title="九、整体对照总结"></a>九、整体对照总结</h2><ul>
<li>playwright-rs：适合『Rust 工程内的自动化测试』</li>
<li>Accessibility Tree：是稳定自动化与 AI 操作的语义基础</li>
<li>agent-browser：把可访问性语义变成可执行协议</li>
<li>LLM + agent-browser：让浏览器自动化从『写 selector』升级为『做决策』</li>
</ul>
<hr>
<h2 id="十、一句话收尾"><a href="#十、一句话收尾" class="headerlink" title="十、一句话收尾"></a>十、一句话收尾</h2><p>DOM 是给浏览器画页面用的，<br>Accessibility Tree 是给『人』理解页面用的，<br>而 agent-browser，是给 AI 操作页面用的。</p>
<br />

<p>这正是现代浏览器自动化正在发生的范式转移。</p>

	</div>

	<div>
  	<center>
	<div class="pagination">
<ul class="pagination">
	 
		
          <li class="prev disabled"><a><i class="fa fa-arrow-circle-o-left"></i>Prev</a></li>
        

        <li><a href="/archives"><i class="fa fa-archive"></i>Archive</a></li>

		
		   <li class="next"><a href="/2026/01/16/LLM-Hallucination/" class="alignright next">Next<i class="fa fa-arrow-circle-o-right"></i></a></li>         
        
	
</ul>
</div>

    </center>
	</div>
	
	<!-- comment -->
	
<section id="comment">
  <h2 class="title">Comments</h2>

  <script data-isso="https://jhub.dtype.info/isso/" src="https://jhub.dtype.info/isso/js/embed.min.js"></script>
  <section id="isso-thread"></section>
  
</section>


	
	</div> <!-- col-md-9/col-md-12 -->
	
	
		<div class="col-md-3"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2026-02-07 
	</div>
	

	<!-- categories -->
    

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/Metaverse/">Metaverse<span>13</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	

</div><!-- row -->

	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2026 Andrew
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a target="_blank" rel="noopener" href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.    
</p> </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


</body>

</html>
